<!-- templates/chat.html -->
{% extends "base.html" %}
{% block content %}

  <!-- Верхняя панель с именем пользователя и кнопкой Logout -->
  <div class="header">
    <p>Logged in as: <strong>{{ session.get('username') }}</strong></p>
    <a href="{{ url_for('logout') }}" class="logout-button">Logout</a>
  </div>

  <h2>Chat Room</h2>

  <!-- Кнопка для перехода на админскую страницу -->
  {% if session.get('is_admin') %}
    <a href="{{ url_for('admin') }}" class="admin-button">Go to Admin Panel</a>
  {% endif %}

  <!-- Форма для фильтрации сообщений -->
  <form method="GET" action="{{ url_for('chat') }}">
      <input type="text" name="search" placeholder="Search messages" value="{{ search_query or '' }}">
      <input type="submit" value="Search">
  </form>

  <!-- Форма для отправки нового сообщения -->
  <form method="POST">
      <textarea name="content" rows="3" cols="40"></textarea>
      <input type="submit" value="Send">
  </form>
  
  <h3>Messages</h3>
  {% if messages %}
    {% for message in messages %}
      <p>
        <strong>{{ message.user.username }}:</strong> {{ message.content }} <br>
        <small>{{ message.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</small>
      </p>
    {% endfor %}
  {% else %}
    <p>No messages found.</p>
  {% endif %}
  
{% endblock %}
